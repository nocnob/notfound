{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/java-tomcat-install/","result":{"data":{"asciidoc":{"id":"00a1e6af-984a-576a-a39d-9874bd84062c","html":"<div class=\"sect1\">\n<h2 id=\"_linux_安装配置_tomcat_9\"><a class=\"anchor\" href=\"#_linux_安装配置_tomcat_9\"></a>Linux 安装配置 Tomcat 9</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_manjaro_linux\"><a class=\"anchor\" href=\"#_manjaro_linux\"></a>Manjaro Linux</h3>\n<div class=\"sect3\">\n<h4 id=\"_安装_tomcat9_tomcat_native\"><a class=\"anchor\" href=\"#_安装_tomcat9_tomcat_native\"></a>安装 tomcat9 tomcat-native</h4>\n<div class=\"paragraph\">\n<p>执行 pacman 直接安装：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">sudo pacman -S tomcat9 tomcat-native</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_通过_systemd_控制_tomcat\"><a class=\"anchor\" href=\"#_通过_systemd_控制_tomcat\"></a>通过 systemd 控制 Tomcat</h4>\n<div class=\"paragraph\">\n<p>systemctl 可启动、重启、停止、查看日志：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\"># 启动 tomcat9\nsudo systemctl start tomcat9.service\n# 停止 tomcat9\nsudo systemctl stop tomcat9.service\n# 重启 tomcat9\nsudo systemctl restart tomcat9.service\n# 开机启动 tomcat9\nsudo systemctl enable tomcat9.service\n# 查看 tomcat9 启动状态\nsystemctl status tomcat9.service\n# 查看日志\njournalctl -f --unit=tomcat9.service</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>访问 <a href=\"http://localhost:8080/\" class=\"bare\">http://localhost:8080/</a></p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_查看环境变量\"><a class=\"anchor\" href=\"#_查看环境变量\"></a>查看环境变量</h4>\n<div class=\"paragraph\">\n<p><code>export</code> 环境变量，方便操作：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\"># 查看环境变量\nsystemctl show tomcat9.service | grep Environment\nexport CATALINA_HOME=/usr/share/tomcat9</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_页面查看_tomcat_运行状态\"><a class=\"anchor\" href=\"#_页面查看_tomcat_运行状态\"></a>页面查看 Tomcat 运行状态</h4>\n<div class=\"paragraph\">\n<p>修改 <code>$CATALINA_HOME/conf/tomcat-users.xml</code> ，在 <code>tomcat-users</code> 标签之间添加：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-xml\" data-lang=\"xml\">&lt;user username=\"tomcat\" password=\"YOUR_PASSWORD\" roles=\"manager-gui\"/&gt;</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>访问 <a href=\"http://localhost:8080/manager/status\" class=\"bare\">http://localhost:8080/manager/status</a> ，输入用户名和密码后，可查看 Tomcat 状态。</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_war_部署\"><a class=\"anchor\" href=\"#_war_部署\"></a>War 部署</h4>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>将 war 放置到 <code>$CATALINA_HOME/webapps/</code> ，文件会自动解压，访问路径会有文件名前缀。如 <code>app.war</code> 访问 URL 为 <a href=\"http://localhost:8080/app\" class=\"bare\">http://localhost:8080/app</a></p>\n</li>\n<li>\n<p><code>ROOT.war</code> ，URL 路径会从根开始，不带任何前缀</p>\n</li>\n</ol>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_绑定新端口_8081\"><a class=\"anchor\" href=\"#_绑定新端口_8081\"></a>绑定新端口 8081</h4>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>编辑 <code>$CATALINA_HOME/conf/server.xml</code></p>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-xml\" data-lang=\"xml\">&lt;Service name=\"App\"&gt;\n  &lt;Connector port=\"8081\" protocol=\"HTTP/1.1\"\n             connectionTimeout=\"20000\"\n             redirectPort=\"8443\" /&gt;\n  &lt;Engine name=\"App\" defaultHost=\"localhost\"&gt;\n    &lt;Host name=\"localhost\"  appBase=\"app\" unpackWARs=\"true\" autoDeploy=\"true\"&gt;\n\n      &lt;Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n             prefix=\"app_access_log\" suffix=\".txt\"\n             pattern=\"%h %l %u %t &amp;quot;%r&amp;quot; %s %b\" /&gt;\n    &lt;/Host&gt;\n  &lt;/Engine&gt;\n&lt;/Service&gt;</code></pre>\n</div>\n</div>\n</li>\n<li>\n<p>创建目录并修改权限</p>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\"># webapps 为软链， 可查看软链指向的目录，在 Manjaro 上为 /var/lib/tomcat9/webapps\nreadlink $CATALINA_HOME/webapps\n# 创建目录\nsudo mkdir /var/lib/tomcat9/app\n# 修改权限\nsudo chown tomcat9:tomcat9 /var/lib/tomcat9/app\n# 创建软链\nsudo ln -s /var/lib/tomcat9/app $CATALINA_HOME/app\n# 设置根路径 war\nsudo cp app.war /var/lib/tomcat9/app/ROOT.war</code></pre>\n</div>\n</div>\n</li>\n</ol>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_手动下载安装\"><a class=\"anchor\" href=\"#_手动下载安装\"></a>手动下载安装</h3>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">wget https://mirrors.bfsu.edu.cn/apache/tomcat/tomcat-9/v9.0.43/bin/apache-tomcat-9.0.43.tar.gz\ntar -zxvf apache-tomcat-9.0.43.tar.gz\nsudo mv apache-tomcat-9.0.43 /opt/tomcat\nexport CATALINA_HOME=/opt/tomcat\n# 启动\n$CATALINA_HOME/bin/startup.sh\n# 停止\n$CATALINA_HOME/bin/shutdown.sh</code></pre>\n</div>\n</div>\n</div>\n</div>\n</div>","document":{"title":"Linux 安装配置 Tomcat 9"},"pageAttributes":{"slug":"java-tomcat-install","category":"java"},"revision":{"date":"2021-02-16","number":"1.0"}}},"pageContext":{"id":"00a1e6af-984a-576a-a39d-9874bd84062c","pageAttributes__slug":"java-tomcat-install","__params":{"pageAttributes__slug":"java-tomcat-install"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}