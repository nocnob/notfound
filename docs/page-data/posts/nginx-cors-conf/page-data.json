{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/nginx-cors-conf/","result":{"data":{"asciidoc":{"id":"703eca35-043b-5e0c-a381-cd5a7bd3da40","html":"<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Nginx CORS 配置</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_配置\"><a class=\"anchor\" href=\"#_配置\"></a>配置</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-nginx\" data-lang=\"nginx\">add_header 'Access-Control-Allow-Origin' '*';\nadd_header 'Access-Control-Allow-Methods' 'GET,POST,OPTIONS';\nadd_header 'Access-Control-Allow-Headers' 'Authorization,Content-Type,Accept,Origin,User-Agent,Cache-Control';\n\nif ($request_method = 'OPTIONS') {\n    return 204;\n}</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>Access-Control-Allow-Origin</code>: <code>*</code> 表示允许所有站点。也可以设置为具体的站点，如 <code><a href=\"http://example.com\" class=\"bare\">http://example.com</a></code>。</p>\n</li>\n<li>\n<p><code>Access-Control-Allow-Methods</code>: 允许客户端发起 <code>GET</code>、<code>POST</code> 和 <code>OPTIONS</code> 请求。</p>\n</li>\n<li>\n<p><code>Access-Control-Allow-Headers</code>: 允许携带的头部。</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_q\"><a class=\"anchor\" href=\"#_q\"></a>Q</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_添加后无效_access_control_allow_origin_依旧无效\"><a class=\"anchor\" href=\"#_添加后无效_access_control_allow_origin_依旧无效\"></a>添加后无效 <code>Access-Control-Allow-Origin</code> 依旧无效</h3>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">Access to fetch at 'http://api.git.test/users' from origin 'http://git.test' has been blocked by CORS policy: The 'Access-Control-Allow-Origin' header contains multiple values 'git.com, git.test', but only one is allowed. Have the server send the header with a valid value, or, if an opaque response serves your needs, set the request's mode to 'no-cors' to fetch the resource with CORS disabled.</code></pre>\n</div>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-nginx\" data-lang=\"nginx\">add_header ‘Access-Control-Allow-Origin’ '*' always;</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>无论何时都生效。</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_携带认证信息\"><a class=\"anchor\" href=\"#_携带认证信息\"></a>携带认证信息</h3>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>一般而言，对于跨域 XMLHttpRequest 或 Fetch 请求，浏览器不会发送身份凭证信息。如果要发送凭证信息，需要设置 XMLHttpRequest 的某个特殊标志位。</p>\n</li>\n<li>\n<p>对于附带身份凭证的请求，服务器不得设置 Access-Control-Allow-Origin 的值为“*”。</p>\n</li>\n</ol>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\"><a class=\"anchor\" href=\"#_参考\"></a>参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://www.ruanyifeng.com/blog/2016/04/cors.html\">跨域资源共享 CORS 详解</a></p>\n</li>\n<li>\n<p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS\">HTTP访问控制（CORS）</a></p>\n</li>\n<li>\n<p><a href=\"https://blog.csdn.net/xiojing825/article/details/83383524\">nginx 配置add_header `Access-Control-Allow-Origin' ’*’ 依然存在跨域问题</a></p>\n</li>\n<li>\n<p><a href=\"https://enable-cors.org/server_nginx.html\">CORS on Nginx</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"Nginx CORS 配置"},"pageAttributes":{"slug":"nginx-cors-conf","category":"linux"},"revision":{"date":"2020-05-01","number":"1.0"}}},"pageContext":{"id":"703eca35-043b-5e0c-a381-cd5a7bd3da40","pageAttributes__slug":"nginx-cors-conf","__params":{"pageAttributes__slug":"nginx-cors-conf"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}