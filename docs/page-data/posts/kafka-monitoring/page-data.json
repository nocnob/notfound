{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/kafka-monitoring/","result":{"data":{"asciidoc":{"id":"bf24cdab-a0c5-5cce-869d-cc8d50033b26","html":"<div class=\"sect1\">\n<h2 id=\"_监控\">监控</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>两种监控方式：</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Kafka Exporter：直接通过 Kafka 协议获取 Kafka 信息。</p>\n</li>\n<li>\n<p>JMX Exporter：通过 JMX 获取 Kafka 信息</p>\n</li>\n</ul>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_prometheus_kafka_exporter\">Prometheus Kafka Exporter</h3>\n<div class=\"paragraph\">\n<p><a href=\"https://github.com/redpanda-data/kminion\" class=\"bare\">https://github.com/redpanda-data/kminion</a></p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\"># 下载\nwget https://github.com/redpanda-data/kminion/releases/download/v2.2.1/kminion_2.2.1_linux_amd64.tar.gz\n# 解压\ntar -xzvf kminion_2.2.1_linux_amd64.tar.gz\n\n# 环境变量方式启动，设置 broker 列表\nexport KAFKA_BROKERS=\"kafka01:9092,kafka02:9092,kafka03:9092\"\n./kminion\n\n# 或通过配置文件启动 https://github.com/redpanda-data/kminion/blob/master/docs/reference-config.yaml\nexport CONFIG_FILEPATH=$PWD/reference-config.yaml\n./kminion</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>默认访问链接 <a href=\"http://127.0.0.1:8080/metrics\" class=\"bare\">http://127.0.0.1:8080/metrics</a></p>\n</div>\n<div class=\"paragraph\">\n<p>Grafana Dashboards: <a href=\"https://github.com/redpanda-data/kminion#-grafana-dashboards\" class=\"bare\">https://github.com/redpanda-data/kminion#-grafana-dashboards</a></p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_prometheus_jms_exporter\">Prometheus JMS Exporter</h3>\n<div class=\"paragraph\">\n<p><a href=\"https://github.com/prometheus/jmx_exporter\" class=\"bare\">https://github.com/prometheus/jmx_exporter</a></p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\"># 下载配置文件\nwget https://raw.githubusercontent.com/prometheus/jmx_exporter/main/example_configs/kafka-2_0_0.yml\ncp kafka-2_0_0.yml /opt/kafka/config/\n\n# 下载 java agent\nwget https://repo1.maven.org/maven2/io/prometheus/jmx/jmx_prometheus_javaagent/0.17.2/jmx_prometheus_javaagent-0.17.2.jar\ncp jmx_prometheus_javaagent-0.17.2.jar /opt/kafka/libs/\n\n# 设置环境变量，端口号为 1234\nexport KAFKA_OPTS=\"-javaagent:/opt/kafka/libs/jmx_prometheus_javaagent-0.17.2.jar=1234:/opt/kafka/config/kafka-2_0_0.yml\"\n# 启动 kafka\nbin/kafka-server-start.sh config/kraft/server.properties</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>访问 <a href=\"http://kafka01:1234/metrics\" class=\"bare\">http://kafka01:1234/metrics</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\">参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://kafka.apache.org/documentation/#monitoring\" class=\"bare\">https://kafka.apache.org/documentation/#monitoring</a></p>\n</li>\n<li>\n<p><a href=\"https://www.confluent.io/blog/monitor-kafka-clusters-with-prometheus-grafana-and-confluent/\" class=\"bare\">https://www.confluent.io/blog/monitor-kafka-clusters-with-prometheus-grafana-and-confluent/</a></p>\n</li>\n<li>\n<p><a href=\"https://www.douyacun.com/article/60f482659925e7fbef70db7836c96d7e\" class=\"bare\">https://www.douyacun.com/article/60f482659925e7fbef70db7836c96d7e</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"Kafka 添加 Prometheus 监控"},"pageAttributes":{"slug":"kafka-monitoring","category":"kafka"},"revision":{"date":"2023-01-06","number":"1.0"}}},"pageContext":{"id":"bf24cdab-a0c5-5cce-869d-cc8d50033b26","pageAttributes__slug":"kafka-monitoring","__params":{"pageAttributes__slug":"kafka-monitoring"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}