{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/http-test-ab/","result":{"data":{"asciidoc":{"id":"84c368cd-002c-5302-aa78-146f3921c49b","html":"<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>使用 ab 进行 HTTP 压力测试，并通过 gnuplot 绘图</p>\n</div>\n<div class=\"paragraph\">\n<p>系统环境：Ubuntu 22.04</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_安装\"><a class=\"anchor\" href=\"#_安装\"></a>安装</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>安装 ab 和 gnuplot</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">sudo apt install apache2-utils <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\nsudo apt install gnuplot</code></pre>\n</div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td>工具 ab 在 apache2-utils 软件包中。</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_测试\"><a class=\"anchor\" href=\"#_测试\"></a>测试</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>测试不同并发数：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">ab -n 1000 -c 10 -g 100n_10c.txt http://localhost:8000/\nab -n 1000 -c 20 -g 100n_20c.txt http://localhost:8000/</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>n</code> 请求总数</p>\n</li>\n<li>\n<p><code>c</code> 同一时间的请求数量</p>\n</li>\n<li>\n<p><code>g</code> 生成 gnuplot 数据文件</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_画图\"><a class=\"anchor\" href=\"#_画图\"></a>画图</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>新建文件 ab.gnuplot ：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"title\">ab.gnuplot</div>\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-gnuplot\" data-lang=\"gnuplot\">set terminal png <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\nset output \"localhost.png\" <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>\nset title \"localhost\" <i class=\"conum\" data-value=\"3\"></i><b>(3)</b>\nset size ratio 0.6 <i class=\"conum\" data-value=\"4\"></i><b>(4)</b>\nset grid y <i class=\"conum\" data-value=\"5\"></i><b>(5)</b>\nset xlabel \"request\" <i class=\"conum\" data-value=\"6\"></i><b>(6)</b>\nset ylabel \"respone time (ms)\" <i class=\"conum\" data-value=\"7\"></i><b>(7)</b>\n\nplot \"100n_10c.txt\" using 9 smooth sbezier with lines title \"10c\", \\\n     \"100n_20c.txt\" using 9 smooth sbezier with lines title \"20c\" <i class=\"conum\" data-value=\"8\"></i><b>(8)</b></code></pre>\n</div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td>生成 PNG 格式文件</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>\n<td>生成的文件名</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"3\"></i><b>3</b></td>\n<td>图片标题</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"4\"></i><b>4</b></td>\n<td>图片大小</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"5\"></i><b>5</b></td>\n<td>图片 Y 轴显示网格</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"6\"></i><b>6</b></td>\n<td>图片 X 轴标签</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"7\"></i><b>7</b></td>\n<td>图片 Y 轴标签</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"8\"></i><b>8</b></td>\n<td>使用 ab 生成的文件绘图，将两次请求数据输出到同一张图中</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>通过 gnuplot 生成文件：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gnuplot ab.gnuplot</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>生成结果如下：</p>\n</div>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/http-test-ab.png\" alt=\"alt\">\n</div>\n<div class=\"title\">Figure 1. ab gnuplot</div>\n</div>\n<div class=\"paragraph\">\n<p>与 ab 输出结果对比，可以看出图表的信息：</p>\n</div>\n<div class=\"listingblock text\">\n<div class=\"title\">ab 输出结果</div>\n<div class=\"content\">\n<pre class=\"highlight\"><code># 并发 10\nPercentage of the requests served within a certain time (ms)\n  50%     14\n  66%     15\n  75%     15\n  80%     16\n  90%     17\n  95%     19\n  98%     23\n  99%     36\n 100%     42 (longest request)\n\n# 并发 20\nPercentage of the requests served within a certain time (ms)\n  50%     21\n  66%     22\n  75%     22\n  80%     23\n  90%     24\n  95%     25\n  98%     27\n  99%     29\n 100%     30 (longest request)</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\"><a class=\"anchor\" href=\"#_参考\"></a>参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://forums.cpanel.net/threads/using-apache-ab-for-benchmarking-and-gnuplot-for-graphing.275542/\" class=\"bare\">https://forums.cpanel.net/threads/using-apache-ab-for-benchmarking-and-gnuplot-for-graphing.275542/</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"HTTP 测试工具：ab"},"pageAttributes":{"slug":"http-test-ab","category":"http"},"revision":{"date":"2022-07-03","number":"1.0"}}},"pageContext":{"id":"84c368cd-002c-5302-aa78-146f3921c49b","pageAttributes__slug":"http-test-ab","__params":{"pageAttributes__slug":"http-test-ab"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}