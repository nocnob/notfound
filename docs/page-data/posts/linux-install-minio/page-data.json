{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/linux-install-minio/","result":{"data":{"asciidoc":{"id":"71d64b93-07fb-5528-8ab0-28435cf10ce5","html":"<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p>系统环境 Ubuntu 20.04</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_安装\"><a class=\"anchor\" href=\"#_安装\"></a>安装</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">wget https://dl.min.io/server/minio/release/linux-amd64/minio\nsudo install -o root -g root -m 0755 minio /usr/local/bin/minio</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_配置_systemd\"><a class=\"anchor\" href=\"#_配置_systemd\"></a>配置 Systemd</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>添加文件 <code>/etc/default/minio</code>：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\"># Volume to be used for MinIO server.\nMINIO_VOLUMES=\"/srv/minio/\"\n# Use if you want to run MinIO on a custom port.\nMINIO_OPTS=\"--address 127.0.0.1:9000 --console-address 127.0.0.1:9001\"\n# Root user for the server.\nMINIO_ROOT_USER=Root-User\n# Root secret for the server.\nMINIO_ROOT_PASSWORD=Root-Password</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>文件中的环境变量会通过 Systemd 传给 minio，根据进行需要修改</p>\n</li>\n<li>\n<p><code>console-address</code> 管理页面使用的监听地址</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>添加文件 <code>/etc/systemd/system/minio.service</code>:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-toml\" data-lang=\"toml\">[Unit]\nDescription=MinIO\nDocumentation=https://docs.min.io\nWants=network-online.target\nAfter=network-online.target\nAssertFileIsExecutable=/usr/local/bin/minio\n\n[Service]\nWorkingDirectory=/usr/local/\n\nUser=minio-user\nGroup=minio-user\nProtectProc=invisible\n\nEnvironmentFile=/etc/default/minio\nExecStartPre=/bin/bash -c \"if [ -z \\\"${MINIO_VOLUMES}\\\" ]; then echo \\\"Variable MINIO_VOLUMES not set in /etc/default/minio\\\"; exit 1; fi\"\n\nExecStart=/usr/local/bin/minio server $MINIO_OPTS $MINIO_VOLUMES\n\n# Let systemd restart this service always\nRestart=always\n\n# Specifies the maximum file descriptor number that can be opened by this process\nLimitNOFILE=65536\n\n# Specifies the maximum number of threads this process can create\nTasksMax=infinity\n\n# Disable timeout logic and wait until process is stopped\nTimeoutStopSec=infinity\nSendSIGKILL=no\n\n[Install]\nWantedBy=multi-user.target\n\n# Built for ${project.name}-${project.version} (${project.name})</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>根据需要修改 <code>User</code> 以及 <code>Group</code></p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\"># 启动\nsudo systemctl start minio.service\n# 查看服务状态\nsystemctl status minio.service\n# 开机启动\nsudo systemctl enable minio.service\n# 禁用开机启动\nsudo systemctl disable minio.service</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>通过 <a href=\"http://127.0.0.1:9000\" class=\"bare\">http://127.0.0.1:9000</a> 可进入 minio 页面。</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_nginx_配置\"><a class=\"anchor\" href=\"#_nginx_配置\"></a>Nginx 配置</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>添加文件 <code>/etc/nginx/conf.d/minio.conf</code>:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-nginx\" data-lang=\"nginx\">server {\n    listen 80;\n    server_name example.com;\n\n    # To allow special characters in headers\n    ignore_invalid_headers off;\n    # Allow any size file to be uploaded.\n    # Set to a value such as 1000m; to restrict file size to a specific value\n    client_max_body_size 100m;\n    # To disable buffering\n    proxy_buffering off;\n\n    location / {\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Host $http_host;\n\n        proxy_connect_timeout 300;\n        # Default is HTTP/1, keepalive is only enabled in HTTP/1.1\n        proxy_http_version 1.1;\n        proxy_set_header Connection \"\";\n        chunked_transfer_encoding off;\n\n        proxy_pass http://localhost:9000; # If you are using docker-compose this would be the hostname i.e. minio\n        # Health Check endpoint might go here. See https://www.nginx.com/resources/wiki/modules/healthcheck/\n        # /minio/health/live;\n    }\n}</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\"><a class=\"anchor\" href=\"#_参考\"></a>参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://docs.min.io/docs/minio-quickstart-guide.html\" class=\"bare\">https://docs.min.io/docs/minio-quickstart-guide.html</a></p>\n</li>\n<li>\n<p><a href=\"https://docs.min.io/docs/setup-nginx-proxy-with-minio.html\" class=\"bare\">https://docs.min.io/docs/setup-nginx-proxy-with-minio.html</a></p>\n</li>\n<li>\n<p><a href=\"https://github.com/minio/minio-service/tree/master/linux-systemd\" class=\"bare\">https://github.com/minio/minio-service/tree/master/linux-systemd</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"Linux 安装配置 Minio"},"pageAttributes":{"slug":"linux-install-minio","category":"minio"},"revision":{"date":"2021-09-04","number":"1.0"}}},"pageContext":{"id":"71d64b93-07fb-5528-8ab0-28435cf10ce5","pageAttributes__slug":"linux-install-minio","__params":{"pageAttributes__slug":"linux-install-minio"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}