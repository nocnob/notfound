{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/monitoring-prometheus/","result":{"data":{"asciidoc":{"id":"e8ea7c9f-f463-5cde-865d-252f98c09c44","html":"<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p>系统环境 Ubuntu 22.04</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_安装\"><a class=\"anchor\" href=\"#_安装\"></a>安装</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>下载 <a href=\"https://prometheus.io/download/\" class=\"bare\">https://prometheus.io/download/</a></p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">wget https://github.com/prometheus/prometheus/releases/download/v2.41.0/prometheus-2.41.0.linux-amd64.tar.gz\n# 解压\ntar -zxvf prometheus-2.41.0.linux-amd64.tar.gz\n# 移动\nsudo mv prometheus-2.41.0.linux-amd64 /opt/prometheus\n# 修改权限\nsudo chown -R $(id -u):$(id -g) /opt/prometheus\n# 启动\n./prometheus --config.file=prometheus.yml</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>访问 <a href=\"http://localhost:9090\" class=\"bare\">http://localhost:9090</a> 即可。</p>\n</div>\n<div class=\"paragraph\">\n<p>目录结构如下：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">....\n├── data            # 数据目录\n├── prometheus      # 执行文件\n├── prometheus.yml  # 配置文件\n├── promtool        # 工具（没用过\n...</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_配置\"><a class=\"anchor\" href=\"#_配置\"></a>配置</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-yml\" data-lang=\"yml\">global:\n  scrape_interval:     15s # 收集数据的时间间隔\n\nscrape_configs:\n  - job_name: 'prometheus' # 作业名称\n\n    # metrics_path defaults to '/metrics'\n    # scheme defaults to 'http'.\n\n    static_configs:\n    - targets: ['localhost:9090']</code></pre>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_metric_类型\"><a class=\"anchor\" href=\"#_metric_类型\"></a>Metric 类型</h3>\n<div class=\"sect3\">\n<h4 id=\"_counter\"><a class=\"anchor\" href=\"#_counter\"></a>Counter</h4>\n<div class=\"paragraph\">\n<p>累加 metric。累加，如 <code>prometheus_http_requests_total</code>。</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_gauge\"><a class=\"anchor\" href=\"#_gauge\"></a>Gauge</h4>\n<div class=\"paragraph\">\n<p>常规 metric。某个值，如 <code>go_goroutines</code>。</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_histogram\"><a class=\"anchor\" href=\"#_histogram\"></a>Histogram</h4>\n<div class=\"paragraph\">\n<p>直方图。请求处理时间，如 <code>prometheus_http_request_duration_seconds_bucket{handler=\"/\",le=\"0.1\"}</code></p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_summary\"><a class=\"anchor\" href=\"#_summary\"></a>Summary</h4>\n<div class=\"paragraph\">\n<p>类似于 Histogram, 典型的应用如：请求持续时间，响应大小。如 <code>prometheus_http_response_size_bytes_bucket{handler=\"/api/v1/query_range\",le=\"100\"}</code></p>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_promql\"><a class=\"anchor\" href=\"#_promql\"></a>PromQL</h2>\n<div class=\"sectionbody\">\n\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\"><a class=\"anchor\" href=\"#_参考\"></a>参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://prometheus.io/docs/prometheus/latest/getting_started/\">GETTING STARTED</a></p>\n</li>\n<li>\n<p><a href=\"https://www.ibm.com/developerworks/cn/cloud/library/cl-lo-prometheus-getting-started-and-practice/index.html\">Prometheus 入门与实践</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"Ubuntu 搭建 Prometheus"},"pageAttributes":{"slug":"monitoring-prometheus","category":"monitoring"},"revision":{"date":"2020-05-14","number":"1.0"}}},"pageContext":{"id":"e8ea7c9f-f463-5cde-865d-252f98c09c44","pageAttributes__slug":"monitoring-prometheus","__params":{"pageAttributes__slug":"monitoring-prometheus"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}