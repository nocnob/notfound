{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/k8s-minikube-install/","result":{"data":{"asciidoc":{"id":"0c2af91e-9dbb-5c1e-b20a-5f0cf5af60a8","html":"<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>系统环境 Manjaro Linux</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_安装\"><a class=\"anchor\" href=\"#_安装\"></a>安装</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_docker\"><a class=\"anchor\" href=\"#_docker\"></a>docker</h3>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">sudo pacman -Sy docker</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>安装 docker</p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">sudo usermod -aG docker $USER</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>将当前用户添加到 docker 组，避免每次执行 docker 命令时添加 sudo (需重新登录才会生效)</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>编辑 <code>/etc/docker/daemon.json</code>:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-json\" data-lang=\"json\">{\n  \"registry-mirrors\": [\"https://ustc-edu-cn.mirror.aliyuncs.com/\"]\n}</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>可选，在 minikube 中并不会生效</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_kubectl\"><a class=\"anchor\" href=\"#_kubectl\"></a>kubectl</h3>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">curl -LO \"https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl\"\nsudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>下载 kubectl 二进制文件并安装</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_minikube\"><a class=\"anchor\" href=\"#_minikube\"></a>minikube</h3>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64\nsudo install minikube-linux-amd64 /usr/local/bin/minikube</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>下载 minikube 二进制文件并安装</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_启动\"><a class=\"anchor\" href=\"#_启动\"></a>启动</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">minikube start --registry-mirror=https://ustc-edu-cn.mirror.aliyuncs.com --image-mirror-country=cn</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>registry-mirror</code> 指定 minikube 使用的 docker 镜像地址</p>\n</li>\n<li>\n<p><code>image-mirror-country</code> 设置 gcr.io 镜像地区，将会从\n<code>registry.cn-hangzhou.aliyuncs.com/google_containers</code> 下载</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>minikube 生成的配置文件 <code>~/.minikube/machines/minikube/config.json</code></p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_docker_2\"><a class=\"anchor\" href=\"#_docker_2\"></a>docker</h3>\n<div class=\"paragraph\">\n<p>默认情况下 <code>docker ps</code> 无法看到 minikube 中的 docker，可执行：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">eval $(minikube -p minikube docker-env)</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>之后可通过执行 <code>docker</code> 相关命令操作 minikube 相关 docker</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\"><a class=\"anchor\" href=\"#_参考\"></a>参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://minikube.sigs.k8s.io/docs/start/\" class=\"bare\">https://minikube.sigs.k8s.io/docs/start/</a></p>\n</li>\n<li>\n<p><a href=\"https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/\" class=\"bare\">https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"Minikube 安装"},"pageAttributes":{"slug":"k8s-minikube-install","category":"k8s"},"revision":{"date":"2021-10-08","number":"1.0"}}},"pageContext":{"id":"0c2af91e-9dbb-5c1e-b20a-5f0cf5af60a8","pageAttributes__slug":"k8s-minikube-install","__params":{"pageAttributes__slug":"k8s-minikube-install"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}