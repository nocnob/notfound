{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/linux-gpgsm-usage/","result":{"data":{"asciidoc":{"id":"b4f1cb1c-8077-5c5e-aae4-f7d12d5951cf","html":"<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Ubuntu 20.04</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_生成自签名证书\"><a class=\"anchor\" href=\"#_生成自签名证书\"></a>生成自签名证书</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gpgsm --generate-key --output=notfound.cn.pem</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>--output</code> 将证书信息保存到 <code>notfound.cn.pem</code></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>创建自签名证书，输入内容如下：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">Create self-signed certificate? (y/N) y\nThese parameters are used:\n    Key-Type: RSA\n    Key-Length: 3072\n    Key-Usage: sign, encrypt\n    Serial: random\n    Name-DN: CN=notfound.cn\n    Name-Email: notfound@notfound.cn</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_导入证书\"><a class=\"anchor\" href=\"#_导入证书\"></a>导入证书</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gpgsm --import notfound.cn.pem</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>查看证书列表:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gpgsm --list-keys</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>输出结果：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">           ID: 0xD4C585CE\n          S/N: 4D22E0B20A614E91\n       Issuer: /CN=notfound.cn\n      Subject: /CN=notfound.cn\n          aka: notfound@notfound.cn\n     validity: 2021-11-26 02:49:05 through 2063-04-05 17:00:00\n     key type: 3072 bit RSA\n    key usage: digitalSignature nonRepudiation keyEncipherment dataEncipherment\n chain length: unlimited\n  fingerprint: 32:C8:B0:FC:89:E7:5C:77:27:F9:64:39:0B:D6:75:B7:D4:C5:85:CE</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_添加到信任列表\"><a class=\"anchor\" href=\"#_添加到信任列表\"></a>添加到信任列表</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_方法_1_gpgsm_签名时添加\"><a class=\"anchor\" href=\"#_方法_1_gpgsm_签名时添加\"></a>方法 1: gpgsm 签名时添加</h3>\n<div class=\"paragraph\">\n<p>利用 gpgsm 弹出框，自动添加</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gpgsm -bsau 0xD4C585CE --sign README.md</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>b(detach-sign)</code> 内容和签名分离</p>\n</li>\n<li>\n<p><code>s(sign)</code> 签名</p>\n</li>\n<li>\n<p><code>a(armor)</code> 输出ASCII 文本</p>\n</li>\n<li>\n<p><code>u(local-user)</code>: KEY ID</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_方法_2_手动添加\"><a class=\"anchor\" href=\"#_方法_2_手动添加\"></a>方法 2: 手动添加</h3>\n<div class=\"paragraph\">\n<p>编辑文件 <code>~/.gnupg/trustlist.txt</code></p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\"># CN=notfound.cn\n32:C8:B0:FC:89:E7:5C:77:27:F9:64:39:0B:D6:75:B7:D4:C5:85:CE S relax</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>指纹</p>\n</li>\n<li>\n<p><code>S</code> 一个标识，作用未知</p>\n</li>\n<li>\n<p><code>relax</code> 放宽对根证书的检查</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>重新加载 <code>gpg-agent</code></p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gpgconf --reload gpg-agent</code></pre>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_导出为_pkcs12\"><a class=\"anchor\" href=\"#_导出为_pkcs12\"></a>导出为 PKCS#12</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gpgsm --export-secret-key-p12 --output=notfound.cn.p12 0xD4C585CE</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\"><a class=\"anchor\" href=\"#_参考\"></a>参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>info gpgsm</code></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"Linux gpgsm 使用"},"pageAttributes":{"slug":"linux-gpgsm-usage","category":"gpg"},"revision":{"date":"2021-11-26","number":"1.0"}}},"pageContext":{"id":"b4f1cb1c-8077-5c5e-aae4-f7d12d5951cf","pageAttributes__slug":"linux-gpgsm-usage","__params":{"pageAttributes__slug":"linux-gpgsm-usage"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}