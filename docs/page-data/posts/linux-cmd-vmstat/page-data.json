{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/linux-cmd-vmstat/","result":{"data":{"asciidoc":{"id":"d309ab3b-c49f-5917-8935-5f20d0d2fefa","html":"<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Linux 环境使用 vmstat 监控系统状态，并通过 gnuplot 画图。</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_vmstat\">vmstat</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>执行：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">vmstat 1 3</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>每 1 秒采集一次数据，共采集 3 次。输出结果：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 0  0      0 3939680 421240 5657676    0    0    51    67  458   71  4  2 93  0  0\n 0  0      0 3939916 421240 5657676    0    0     0     0 2935 9898  2  1 97  0  0\n 1  0      0 3939916 421248 5657668    0    0     0   124 3246 10485  2  1 96  0  0</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>procs</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>r 等待 CPU 的进程数</p>\n</li>\n<li>\n<p>b 不可中断休眠</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>memory</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>swpd 被换出到磁盘的块</p>\n</li>\n<li>\n<p>free 空闲块数</p>\n</li>\n<li>\n<p>buff 缓冲块数</p>\n</li>\n<li>\n<p>cache 系统缓存块数</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>swap</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>si 从磁盘换入</p>\n</li>\n<li>\n<p>so 换出到磁盘</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>io</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>bi 从设备读取块数</p>\n</li>\n<li>\n<p>bo 从设备写出块数</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>system</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>in 每秒中断次数</p>\n</li>\n<li>\n<p>cs 上下文切换次数</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>cpu</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>us 用户代码</p>\n</li>\n<li>\n<p>sy 系统代码</p>\n</li>\n<li>\n<p>id 空闲</p>\n</li>\n<li>\n<p>wa 等待 IO</p>\n</li>\n<li>\n<p>st</p>\n</li>\n</ul>\n</div>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_gnuplot_画图\">gnuplot 画图</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_数据\">数据</h3>\n<div class=\"paragraph\">\n<p>通过 vmstat 生成数据</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">vmstat 1 10 | grep -v r &gt; vmstat.txt</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>每 1 秒采集一次数据，采集 10 次</p>\n</li>\n<li>\n<p>排除掉掉包含 <code>r</code> 的行（第 1,2 行）</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_画图\">画图</h3>\n<div class=\"listingblock\">\n<div class=\"title\">vmstat.gnuplot</div>\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-gnuplot\" data-lang=\"gnuplot\"># set terminal qt persist\nset terminal svg <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\nset output 'vmstat.svg' <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>\n\nset title 'vmstat 1 10'\nset xlabel \"Time (sec)\"\n\n<i class=\"conum\" data-value=\"3\"></i><b>(3)</b>\nplot \\\n         'vmstat.txt' using 13 with lines linewidth 2 title 'CPU user load', \\\n         'vmstat.txt' using 14 with lines linewidth 2 title 'CPU system load', \\\n         'vmstat.txt' using 15 with lines linewidth 2 title 'CPU idle time', \\\n         'vmstat.txt' using 16 with lines linewidth 2 title 'CPU IO wait time'</code></pre>\n</div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td>生成 SVG</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>\n<td>输出文件名</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"3\"></i><b>3</b></td>\n<td>使用 13 到 16 列划线图</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>之后，执行命令：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gnuplot vmstat.gnuplot</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>生成图片：</p>\n</div>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/vmstat.svg\" alt=\"vm stat\">\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\">参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"http://www.linuxintro.org/wiki/Gnuplot\" class=\"bare\">http://www.linuxintro.org/wiki/Gnuplot</a></p>\n</li>\n<li>\n<p><a href=\"http://ouc.ai/zhenghaiyong/courses/tutorials/gnuplot/gnuplot-zh.pdf\" class=\"bare\">http://ouc.ai/zhenghaiyong/courses/tutorials/gnuplot/gnuplot-zh.pdf</a></p>\n</li>\n<li>\n<p><a href=\"https://book.douban.com/subject/23008813/\">《 高性能MySQL(第3版) 》</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"Linux 环境使用 vmstat 分析系统状态"},"pageAttributes":{"slug":"linux-cmd-vmstat","category":"linux"},"revision":{"date":"2022-07-07","number":"1.0"}}},"pageContext":{"id":"d309ab3b-c49f-5917-8935-5f20d0d2fefa","pageAttributes__slug":"linux-cmd-vmstat","__params":{"pageAttributes__slug":"linux-cmd-vmstat"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}