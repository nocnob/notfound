{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/linux-nginx-https/","result":{"data":{"asciidoc":{"id":"fc33ea96-46dc-56b5-a6c7-a50539558dac","html":"<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-ruby\" data-lang=\"ruby\">require 'json'\n\nHTTPS                   = 'HTTPS'\nHTTP_X_FORWARDED_SSL    = 'HTTP_X_FORWARDED_SSL'\nHTTP_X_FORWARDED_SCHEME = 'HTTP_X_FORWARDED_SCHEME'\nHTTP_X_FORWARDED_PROTO  = 'HTTP_X_FORWARDED_PROTO'\nRACK_URL_SCHEME         = 'rack.url_scheme'\n\nclass Test\n  def call(env)\n    req = Rack::Request.new(env)\n    data = {\n      ssl: req.ssl?,\n      HTTPS: req.get_header(HTTPS),\n      HTTP_X_FORWARDED_SSL: req.get_header(HTTP_X_FORWARDED_SSL),\n      HTTP_X_FORWARDED_SCHEME: req.get_header(HTTP_X_FORWARDED_SCHEME),\n      HTTP_X_FORWARDED_PROTO: req.get_header(HTTP_X_FORWARDED_PROTO),\n      RACK_URL_SCHEME: req.get_header(RACK_URL_SCHEME),\n    }\n    puts data\n    [200, { 'Content-Type' =&gt; 'application/json' }, [JSON.pretty_generate(data)]]\n  end\nend\n\nrun Test.new</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\"><a class=\"anchor\" href=\"#_参考\"></a>参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/forwarded/\" class=\"bare\">https://www.nginx.com/resources/wiki/start/topics/examples/forwarded/</a></p>\n</li>\n<li>\n<p><a href=\"https://serverfault.com/questions/515957/how-to-have-nginx-forward-the-http-x-forwarded-proto-header\" class=\"bare\">https://serverfault.com/questions/515957/how-to-have-nginx-forward-the-http-x-forwarded-proto-header</a></p>\n</li>\n<li>\n<p><a href=\"https://www.digitalocean.com/community/questions/configure-nginx-ssl-force-http-to-redirect-to-https-force-www-to-non-www-on-serverpilot-free-plan-using-nginx-configuration-file-only\" class=\"bare\">https://www.digitalocean.com/community/questions/configure-nginx-ssl-force-http-to-redirect-to-https-force-www-to-non-www-on-serverpilot-free-plan-using-nginx-configuration-file-only</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"Linux Nginx https 配置"},"pageAttributes":{"slug":"linux-nginx-https","category":"nginx"},"revision":{"date":"2022-01-13","number":"1.0"}}},"pageContext":{"id":"fc33ea96-46dc-56b5-a6c7-a50539558dac","pageAttributes__slug":"linux-nginx-https","__params":{"pageAttributes__slug":"linux-nginx-https"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}