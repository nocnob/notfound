{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/oauth2/","result":{"data":{"asciidoc":{"id":"03c18beb-5190-53c5-9dc5-1e182f154924","html":"<div class=\"sect1\">\n<h2 id=\"_术语\"><a class=\"anchor\" href=\"#_术语\"></a>术语</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p>资源所有者(resource owner): 用户实体</p>\n</li>\n<li>\n<p>资源服务器(resource server): 保存了用户受保护的资源</p>\n</li>\n<li>\n<p>客户端(client): 应用程序，该程序想获取资源所有者(resource owner)在资源服务器(resource server)上的受保护的资源</p>\n</li>\n<li>\n<p>授权服务器(authorization server): 可以验证资源所有者</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_过程\"><a class=\"anchor\" href=\"#_过程\"></a>过程</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_资源所有者与资源服务器\"><a class=\"anchor\" href=\"#_资源所有者与资源服务器\"></a>资源所有者与资源服务器</h3>\n<div class=\"paragraph\">\n<p>资源所有者(resource owner)获取资源流程：</p>\n</div>\n<div class=\"paragraph\">\n<p>资源所有者(resource owner) –&gt; 登录(用户名+密码) –&gt; 资源服务器(resource\nserver)</p>\n</div>\n<div class=\"paragraph\">\n<p>能否直接将资源所有者换成客户端?</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_客户端与资源服务器\"><a class=\"anchor\" href=\"#_客户端与资源服务器\"></a>客户端与资源服务器</h3>\n<div class=\"paragraph\">\n<p>第三方客户端(client) –&gt; 登录(用户名+密码) –&gt; 资源服务器(resource server)</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>三方客户端为避免重复申请授权，很可能保存用户名和密码</p>\n</li>\n<li>\n<p>三方客户端权限过大，操作不受限制</p>\n</li>\n<li>\n<p>三方客户端的是否能访问资源和用户名、密码强关联</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>修改密码前，三方客户端可以访问</p>\n</li>\n<li>\n<p>修改密码后，三方客户端不能访问</p>\n</li>\n</ul>\n</div>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_授权服务器\"><a class=\"anchor\" href=\"#_授权服务器\"></a>授权服务器</h3>\n<div class=\"paragraph\">\n<p>要解决上述问题，可以给三方客户端(client)一个访问令牌(access\ntoken)，并设置过期时间(expires_in)以及访问范围(scope):</p>\n</div>\n<div class=\"paragraph\">\n<p>第三方客户端(client) –&gt; 访问令牌(access token) –&gt; 资源服务器(resource server)</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>令牌权限有限</p>\n</li>\n<li>\n<p>令牌可随时注销</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>授权服务器(authorization server)验证资源所有者(resource owner)，并生成一个受限的访问令牌(access token)。在生成令牌前，资源所有者可指定访问令牌的访问范围(scope)，</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_oauth_2_0_协议流程\"><a class=\"anchor\" href=\"#_oauth_2_0_协议流程\"></a>OAuth 2.0 协议流程</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">     +--------+                               +---------------+\n     |        |--(A)- Authorization Request -&gt;|   Resource    |\n     |        |                               |     Owner     |\n     |        |&lt;-(B)-- Authorization Grant ---|               |\n     |        |                               +---------------+\n     |        |\n     |        |                               +---------------+\n     |        |--(C)-- Authorization Grant --&gt;| Authorization |\n     | Client |                               |     Server    |\n     |        |&lt;-(D)----- Access Token -------|               |\n     |        |                               +---------------+\n     |        |\n     |        |                               +---------------+\n     |        |--(E)----- Access Token ------&gt;|    Resource   |\n     |        |                               |     Server    |\n     |        |&lt;-(F)--- Protected Resource ---|               |\n     +--------+                               +---------------+\n\n                     Figure 1: Abstract Protocol Flow</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>A. 客户端向资源所有者请求授权</p>\n</li>\n<li>\n<p>B. 资源所有者同意授权给客户端</p>\n</li>\n<li>\n<p>C. 客户端通过上一步的授权许可，向认证服务器申请访问令牌</p>\n</li>\n<li>\n<p>D. 认证服务器发放访问令牌给客户端</p>\n</li>\n<li>\n<p>E. 客户通过访问令牌向资源服务器请求受保护的资源</p>\n</li>\n<li>\n<p>F. 资源服务器将受保护的资源发送给客户端</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_参考\"><a class=\"anchor\" href=\"#_参考\"></a>参考</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html\" class=\"bare\">http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html</a></p>\n</li>\n<li>\n<p><a href=\"https://www.rfc-editor.org/rfc/rfc6749.txt\" class=\"bare\">https://www.rfc-editor.org/rfc/rfc6749.txt</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"OAuth 2.0 简介"},"pageAttributes":{"slug":"oauth2","category":"http"},"revision":{"date":"2021-09-20","number":"1.0"}}},"pageContext":{"id":"03c18beb-5190-53c5-9dc5-1e182f154924","pageAttributes__slug":"oauth2","__params":{"pageAttributes__slug":"oauth2"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}