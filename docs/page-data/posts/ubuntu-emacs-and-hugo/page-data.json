{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/ubuntu-emacs-and-hugo/","result":{"data":{"asciidoc":{"id":"05199ed9-9391-50fc-a6a5-c5b93085a13e","html":"<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p><a href=\"https://github.com/syl20bnr/spacemacs/tree/develop/layers/+emacs/org#hugo-support\">Spacemacs org layer</a> 提供了对 <a href=\"https://gohugo.io\">Hugo</a> 的支持。</p>\n</div>\n<div class=\"paragraph\">\n<p>工作过程：https://ox-hugo.scripter.co/[ox-hugo] 把 org 文档转换为 Hugo markdown，Hugo 再将 markdown 转换为 html。</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_hugo\"><a class=\"anchor\" href=\"#_hugo\"></a>Hugo</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_安装\"><a class=\"anchor\" href=\"#_安装\"></a>安装</h3>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">sudo snap install hugo\nsudo apt install python-pygments</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_搭建\"><a class=\"anchor\" href=\"#_搭建\"></a>搭建</h3>\n<div class=\"paragraph\">\n<p>使用 <a href=\"https://github.com/spf13/hyde\">Hyde</a> 主题</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">hugo new site notfound.cn\ncd notfound.cn\ngit init\ngit add .\ngit submodule add https://github.com/spf13/hyde.git themes/hyde</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_配置\"><a class=\"anchor\" href=\"#_配置\"></a>配置</h3>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>语法高亮\n<a href=\"https://gohugo.io/content-management/syntax-highlighting/#configure-syntax-highlighter\">Configure Syntax Highlighter</a></p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-toml\" data-lang=\"toml\">PygmentsCodeFences = true # Enable syntax highlighting with GitHub flavoured code fences\nPygmentsUseClasses = true # Use CSS classes to format highlighted code</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_编译\"><a class=\"anchor\" href=\"#_编译\"></a>编译</h3>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">hugo -s notfound.cn -d /var/www/notfound.cn</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>-s</code> 指定源目录</p>\n</li>\n<li>\n<p><code>-d</code> 指定目标目录</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>本地实时预览：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">hugo server -D</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>远程编译：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">ssh -T notfound.cn hugo -s work/notfound.cn -d /var/www/notfound.cn</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>需要配置 ssh key</p>\n</li>\n<li>\n<p>直接在服务上执行命令，省掉了登录的步骤</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_emacs_hugo_配置\"><a class=\"anchor\" href=\"#_emacs_hugo_配置\"></a>Emacs hugo 配置</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>修改 spacemacs 配置，开启 org hugo 支持 <a href=\"https://github.com/syl20bnr/spacemacs/tree/develop/layers/+emacs/org#hugo-support\">Hugo support</a></p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-lisp\" data-lang=\"lisp\">(setq-default dotspacemacs-configuration-layers '(\n  (org :variables\n       org-enable-hugo-support t)))</code></pre>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_org_文件配置\"><a class=\"anchor\" href=\"#_org_文件配置\"></a>Org 文件配置</h3>\n<div class=\"paragraph\">\n<p>ox-hugo 支持两种导出方式。</p>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_子节点树作为博客内容推荐\"><a class=\"anchor\" href=\"#_子节点树作为博客内容推荐\"></a>子节点树作为博客内容（推荐）</h4>\n<div class=\"paragraph\">\n<p>将一个子节点树作为一篇博客，可参考 <a href=\"https://ox-hugo.scripter.co/#screenshot-one-post-per-subtree\">One post per Org subtree (preferred)</a></p>\n</div>\n<div class=\"paragraph\">\n<p>博客文件目录结构：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">.\n├── content\n├── content-org\n│   └── posts.org\n...</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>所有博客内容都保存在 <code>posts.org</code> 文件中</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>在 <code>posts.org</code> 头部添加：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">#+HUGO_BASE_DIR: ../\n#+HUGO_BASESECTION: ./</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>#+HUGO_BASE_DIR:</code> Hugo 博客根目录设置为上级目录</p>\n</li>\n<li>\n<p><code>#+HUGO_BASESECTION:</code> Hugo section</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>在 <code>posts.org</code> 子节点添加：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">:PROPERTIES:\n:EXPORT_FILE_NAME: ubuntu-emacs-and-hugo\n:END:\n\n#+HUGO: more</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>EXPORT_FILE_NAME</code> 指定导出的文件名</p>\n</li>\n<li>\n<p><code>HUGO: more</code> 文件预览截断点，可参考 <a href=\"https://ox-hugo.scripter.co/doc/hugo-summary-splitter/\">Hugo Summary Splitter</a></p>\n</li>\n<li>\n<p>生成的文件会保存到 <code>HUGO_BASE_DIR/content/posts/ubuntu-emacs-and-hugo.md</code></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>ox-hugo 导出时会使用 org 文件的部分信息，可参考 <a href=\"https://ox-hugo.scripter.co/doc/org-meta-data-to-hugo-front-matter/#for-subtree-based-exports\">For subtree-based exports</a></p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-org\" data-lang=\"org\">** DONE 使用 spacemacs 和 hugo 写博客        :emacs:hugo:\n   CLOSED: [2018-12-23 Sun 10:18]</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>TODO</code> 为草稿， <code>DONE</code> 才会正式发布，没有状态的子节点不会自动转换</p>\n</li>\n<li>\n<p>org tags 会转换为 Hugo markdown 的 tags</p>\n</li>\n<li>\n<p><code>CLOSED</code> 的时间点会转换为 Hugo markdown 的 date</p>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_org_文件作为博客内容\"><a class=\"anchor\" href=\"#_org_文件作为博客内容\"></a>Org 文件作为博客内容</h4>\n<div class=\"paragraph\">\n<p>可参考 <a href=\"https://ox-hugo.scripter.co/#screenshot-one-post-per-file\">One post per Org file</a></p>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_保存后自动导出_auto_export_on_saving\"><a class=\"anchor\" href=\"#_保存后自动导出_auto_export_on_saving\"></a>保存后自动导出 <a href=\"https://ox-hugo.scripter.co/doc/auto-export-on-saving\">Auto-export on Saving</a></h3>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>目录下所有文件导出。在目录下创建文件 <code>.dir-locals.el</code> 并添加如下内容，\n<code>content-org</code> 目录下的文件都会被自动导出为 hugo markdown：</p>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-lisp\" data-lang=\"lisp\">((\"content-org/\"\n  . ((org-mode . ((eval . (org-hugo-auto-export-mode)))))))</code></pre>\n</div>\n</div>\n</li>\n<li>\n<p>单个文件自动导出</p>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-org\" data-lang=\"org\">​* Footnotes\n​* COMMENT Local Variables                          :ARCHIVE:\n# Local Variables:\n# eval: (org-hugo-auto-export-mode)\n# End:</code></pre>\n</div>\n</div>\n</li>\n<li>\n<p>可配置单个文件不导出</p>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-org\" data-lang=\"org\">​* Footnotes\n​* COMMENT Local Variables                          :ARCHIVE:\n# Local Variables:\n# eval: (org-hugo-auto-export-mode -1)\n# End:</code></pre>\n</div>\n</div>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>","document":{"title":"使用 spacemacs 和 hugo 写博客"},"pageAttributes":{"slug":"ubuntu-emacs-and-hugo","category":"blog"},"revision":{"date":"2018-12-23","number":"1.0"}}},"pageContext":{"id":"05199ed9-9391-50fc-a6a5-c5b93085a13e","pageAttributes__slug":"ubuntu-emacs-and-hugo","__params":{"pageAttributes__slug":"ubuntu-emacs-and-hugo"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}