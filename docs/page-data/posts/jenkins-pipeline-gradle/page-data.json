{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/jenkins-pipeline-gradle/","result":{"data":{"asciidoc":{"id":"47f034eb-809f-58dc-a85b-d142c28f43a1","html":"<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Ubuntu 22.04</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_概览\"><a class=\"anchor\" href=\"#_概览\"></a>概览</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>使用 Git + Jenkins 进行持续集成、测试基本流程如下：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-plantuml\" data-lang=\"plantuml\">@startuml\nparticipant gc as \"Git Client\"\nparticipant gs as \"Git Server\"\nparticipant jk as \"Jenkins\"\n\nactivate gc\n  gc --&gt; gs : git push, ssh\n  activate gs\n    gs --&gt; jk : git hook, http\n    activate jk\n    gs &lt;-- jk\n    gc &lt;-- gs\n  deactivate gs\ndeactivate gc\n\n    gs &lt;-- jk : git clone; ssh\n    activate gs\n    gs --&gt; jk\n    deactivate gs\n    deactivate jk\n@enduml</code></pre>\n</div>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Git Client 通过 SSH 方式推送代码到 Git Server；</p>\n</li>\n<li>\n<p>代码推送完成后，Git Server 执行 Git Hook， 可通过 Git Hook 触发 Jenkins 构建；</p>\n</li>\n<li>\n<p>Jenkins 构建时，需要通过 SSH 从 Git Server 拉取代码。</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>在本地演示整个配置流程：</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Git Server，使用本地 git 用户，SSH 地址 git@localhost</p>\n</li>\n<li>\n<p>Git Client，当前用户</p>\n</li>\n<li>\n<p>Jenkins 本地测试地址 <a href=\"http://jenkins.notfound.cn\" class=\"bare\">http://jenkins.notfound.cn</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_git_server\"><a class=\"anchor\" href=\"#_git_server\"></a>Git Server</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>配置 Git Server，可通过 SSH 方式推、拉代码。</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_环境准备\"><a class=\"anchor\" href=\"#_环境准备\"></a>环境准备</h3>\n<div class=\"paragraph\">\n<p>安装依赖并创建 Git 用户：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">sudo apt install git openssh-server # 安装 ssh 服务端，以通过 ssh 方式拉取代码\nsudo adduser git # 创建 git 用户、组，同时创建 HOME 目录</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_创建仓库\"><a class=\"anchor\" href=\"#_创建仓库\"></a>创建仓库</h3>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">su - git # 切换到 Git 用户\ngit init ~/git-data/pipeline-gradle.git --bare # 创建裸仓库</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_创建_git_hook\"><a class=\"anchor\" href=\"#_创建_git_hook\"></a>创建 Git Hook</h3>\n<div class=\"paragraph\">\n<p>Git 包含了很多钩子，这里使用 <a href=\"https://git-scm.com/docs/githooks/2.36.0#post-receive\">Post Receive</a> ，代码推送完成后会触发一次。需要从标准输入读取分支信息：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"title\">~/git-data/pipeline-gradle.git/hooks/post-receive</div>\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">#!/bin/sh\n\n# 每次从标准输入读取一行，每行包括三部分，使用空格分隔\nwhile read oldrev newrev refname\ndo\n  if [ $refname = \"refs/heads/main\" ]; then # 推送 main 分支时，向 jenkins 发送请求\n    # 在配置 Jenkins Pipeline 时， Jenkins 会给出一个链接，后面会讲到 <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\n    curl -sS --user admin:YOUR_PASSWORD \"http://jenkins.notfound.cn/job/pipeline-gradle/build?token=TOKEN_NAME\"\n  fi\ndone</code></pre>\n</div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td>使用 Jenkins 用户名和密码</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>文件需要添加可执行权限 <code>chmod u+x post-receive</code></p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_git_client\"><a class=\"anchor\" href=\"#_git_client\"></a>Git Client</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>打开一个新终端，切换到非 git 用户。</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_ssh_认证\"><a class=\"anchor\" href=\"#_ssh_认证\"></a>SSH 认证</h3>\n<div class=\"paragraph\">\n<p>Git Client 和 Git Server 通过 SSH 协议通信，首先需要处理认证问题：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">ssh-keygen -t ed25519 -C \"git-client-to-git-server\" # 本地生成 SSH KEY，用于访问 git server\nssh-copy-id -i ~/.ssh/id_ed25519.pub git@localhost    # 将 SSH 公钥复制到 git server</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>完成操作后，Git Client 和 Git Server 可通过 SSH 免密访问。</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_gradle_项目\"><a class=\"anchor\" href=\"#_gradle_项目\"></a>Gradle 项目</h3>\n<div class=\"paragraph\">\n<p>接下来，从 Git Server 拉取代码：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">git clone git@localhost:git-data/pipeline-gradle.git</code></pre>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_初始化\"><a class=\"anchor\" href=\"#_初始化\"></a>初始化</h4>\n<div class=\"paragraph\">\n<p>在 <code>pipeline-gradle</code> 目录中初始化 gradle 项目：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gradle init \\\n       --dsl=groovy \\\n       --package=demo \\\n       --project-name=demo  \\\n       --test-framework=junit-jupiter \\\n       --type=java-application</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>如果 maven 依赖下载太慢，可编辑 <code>app/build.gradle</code> 添加国内的 maven 源：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"title\">app/build.gradle</div>\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-diff\" data-lang=\"diff\"> repositories {\n+    maven { url 'https://maven.aliyun.com/repository/public/' }\n     // Use Maven Central for resolving dependencies.\n     mavenCentral()\n }</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_测试\"><a class=\"anchor\" href=\"#_测试\"></a>测试</h4>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gradle test</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>测试完成后，会生成测试报告 <code>app/build/test-results/test/TEST-*.xml</code>，我们希望 Jenkins 保留这份报告。</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_打包\"><a class=\"anchor\" href=\"#_打包\"></a>打包</h4>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">gradle distZip</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>打包生成 <code>app/build/distributions/*.zip</code>，我们希望 Jenkins 保留打包后的 zip 文件。</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_提交\"><a class=\"anchor\" href=\"#_提交\"></a>提交</h4>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">git add -A\ngit commit -m \"Initial commit\"</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>暂不推送。完成 Jenkins 配置后再推送。</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_jenkins\"><a class=\"anchor\" href=\"#_jenkins\"></a>Jenkins</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_认证\"><a class=\"anchor\" href=\"#_认证\"></a>认证</h3>\n<div class=\"sect3\">\n<h4 id=\"_本地生成_ssh_key\"><a class=\"anchor\" href=\"#_本地生成_ssh_key\"></a>本地生成 SSH Key</h4>\n<div class=\"paragraph\">\n<p>生成 SSH 密钥对，用于 Jenkins 从 Git Server 拉取代码，从这个角度看，Jenkins 是一个普通的 Git Client。</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">ssh-keygen -t ed25519 -f jenkins-to-git-localhost -C jenkins-to-git@localhost\nssh-copy-id -i jenkins-to-git-localhost git@localhost # 将公钥复制到 Git Server</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>之后，将 SSH <code>jenkins-to-git-localhost</code> 私匙复制到 Jenkins。</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_jenkins_添加凭据\"><a class=\"anchor\" href=\"#_jenkins_添加凭据\"></a>Jenkins 添加凭据</h4>\n<div class=\"paragraph\">\n<p>Dashboard &#8594; Manage Jenkins &#8594; Manage Credentials &#8594; (global) &#8594; Add Credentials</p>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"http://jenkins.notfound.cn/credentials/store/system/domain/_/newCredentials\" class=\"bare\">http://jenkins.notfound.cn/credentials/store/system/domain/_/newCredentials</a> ：</p>\n</div>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/jenkins-pipeline-new-credentials-ssh.png\" alt=\"jenkins-pipeline-new-credentials-ssh.png\" width=\"500\">\n</div>\n<div class=\"title\">Figure 1. 添加 SSH 凭据</div>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<caption class=\"title\">Table 1. New credentials 表单</caption>\n<colgroup>\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3334%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">属性</th>\n<th class=\"tableblock halign-left valign-top\">值</th>\n<th class=\"tableblock halign-left valign-top\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Kind</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">SSH Username with private key</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">认证类型，SSH</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Scope</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Global (Jenkins, nodes, items, all child items, etc)</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">作用域，全局</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">ID</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">jenkins-to-git-localhost</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">使用凭据时，通过 ID 指定</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Description</p></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">凭据描述</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Username</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">git</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">用户名</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Private Key &#8594; Enter directly</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>-----BEGIN OPENSSH PRIVATE KEY&#8230;&#8203;</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">SSH 私钥，复制文件 <code>jenkins-to-git-localhost</code> 内容</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Passphrase</p></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">密码，如果私钥加密了需要填写</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_配置_gradle\"><a class=\"anchor\" href=\"#_配置_gradle\"></a>配置 Gradle</h3>\n<div class=\"paragraph\">\n<p>Dashboard &#8594; Manage Jenkins &#8594; Global Tool Configuration &#8594; Gradle</p>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"http://jenkins.notfound.cn/manage/configureTools/\" class=\"bare\">http://jenkins.notfound.cn/manage/configureTools/</a></p>\n</div>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/jenkins-pipeline-config-tools-gradle.png\" alt=\"jenkins-pipeline-config-tools-gradle\" width=\"500\">\n</div>\n<div class=\"title\">Figure 2. 配置 Gradle</div>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<caption class=\"title\">Table 2. Gradle 表单</caption>\n<colgroup>\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3334%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">属性</th>\n<th class=\"tableblock halign-left valign-top\">值</th>\n<th class=\"tableblock halign-left valign-top\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">name</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">7.5</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">指定 gradle 时需要</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Install automatically</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Install from Gradle.org</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gradle 安装方式</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Version</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gradle 7.5</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gradle 版本</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_配置_job\"><a class=\"anchor\" href=\"#_配置_job\"></a>配置 Job</h3>\n<div class=\"paragraph\">\n<p>Dashboard &#8594; New Item</p>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"http://jenkins.notfound.cn/view/all/newJob\" class=\"bare\">http://jenkins.notfound.cn/view/all/newJob</a></p>\n</div>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/jenkins-pipeline-newjob.png\" alt=\"jenkins-pipeline-newjob\" width=\"500\">\n</div>\n<div class=\"title\">Figure 3. 添加 Job</div>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<caption class=\"title\">Table 3. New Job 表单</caption>\n<colgroup>\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3334%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">属性</th>\n<th class=\"tableblock halign-left valign-top\">值</th>\n<th class=\"tableblock halign-left valign-top\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Enter an item name</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">pipeline-gradle</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Job 名称</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Pipeline</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Job 类型</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"sect3\">\n<h4 id=\"_配置触发器\"><a class=\"anchor\" href=\"#_配置触发器\"></a>配置触发器</h4>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/jenkins-pipeline-gradle-build-triggers.png\" alt=\"jenkins-pipeline-gradle-build-triggers\" width=\"500\">\n</div>\n<div class=\"title\">Figure 4. 配置触发器</div>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<caption class=\"title\">Table 4. 触发器表单</caption>\n<colgroup>\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3334%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">属性</th>\n<th class=\"tableblock halign-left valign-top\">值</th>\n<th class=\"tableblock halign-left valign-top\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Build Triggers</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Trigger builds remotely (e.g., from scripts)</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">触发器类型</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Authentication Token</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">TOKEN_NAME</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">TOKEN</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"paragraph\">\n<p>触发器的链接为 <code>JENKINS_URL/job/pipeline-gradle-1/build?token=TOKEN_NAME</code>，向该链接发送 GET 请求可以出发构建，默认还需要携带用户认证信息，如：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">curl --user admin:YOUR_PASSWORD \"http://jenkins.notfound.cn/job/pipeline-gradle/build?token=TOKEN_NAME\"</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_配置_pipeline\"><a class=\"anchor\" href=\"#_配置_pipeline\"></a>配置 Pipeline</h4>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/jenkins-pipeline-gradle-pipeline.png\" alt=\"jenkins-pipeline-gradle-pipeline\" width=\"500\">\n</div>\n<div class=\"title\">Figure 5. 配置 Pipeline</div>\n</div>\n<div class=\"paragraph\">\n<p>Definition 选择 Pipeline script。</p>\n</div>\n<div class=\"paragraph\">\n<p>底部有个 <code>Pipeline Syntax</code> 链接，通过该链接生成 pipeline 片段。</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"title\">Pipeline script</div>\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-groovy\" data-lang=\"groovy\">pipeline {\n    agent any // 执行节点，任意节点\n    tools { gradle '7.5' } <i class=\"conum\" data-value=\"1\"></i><b>(1)</b>\n    stages {\n        stage('Source') {\n            steps {\n                <i class=\"conum\" data-value=\"2\"></i><b>(2)</b>\n                git branch: 'main', credentialsId: 'jenkins-to-git-localhost', url: 'git@localhost:git-data/pipeline-gradle.git'\n            }\n        }\n        stage('Test') {\n            steps {\n                sh 'gradle test' // 执行测试\n            }\n            post {\n                success {\n                    junit 'app/build/test-results/test/TEST-*.xml' // 收集测试报告\n                }\n            }\n        }\n        stage('Build') {\n            steps {\n                sh 'gradle distZip' // 执行打包\n            }\n            post {\n                success {\n                    archiveArtifacts 'app/build/distributions/*.zip' // 收集打包好的文件\n                }\n            }\n        }\n    }\n}</code></pre>\n</div>\n</div>\n<div class=\"colist arabic\">\n<table>\n<tr>\n<td><i class=\"conum\" data-value=\"1\"></i><b>1</b></td>\n<td><a href=\"http://jenkins.notfound.cn/job/pipeline-gradle/directive-generator/\" class=\"bare\">http://jenkins.notfound.cn/job/pipeline-gradle/directive-generator/</a> 生成 tools 信息</td>\n</tr>\n<tr>\n<td><i class=\"conum\" data-value=\"2\"></i><b>2</b></td>\n<td><a href=\"http://jenkins.notfound.cn/job/pipeline-gradle/pipeline-syntax/\" class=\"bare\">http://jenkins.notfound.cn/job/pipeline-gradle/pipeline-syntax/</a> 生成 git 信息</td>\n</tr>\n</table>\n</div>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/jenkins-pipeline-gradle-git.png\" alt=\"jenkins-pipeline-gradle-git.png\" width=\"500\">\n</div>\n<div class=\"title\">Figure 6. 生成 git 插件代码片段</div>\n</div>\n<div class=\"paragraph\">\n<p>其他信息也可以使用同样的方式生成。</p>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_git_client_推送代码\"><a class=\"anchor\" href=\"#_git_client_推送代码\"></a>Git Client 推送代码</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>回到本地 pipeline-gradle 仓库目录，执行推送：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">git push origin main</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>之后，会触发 Jenkins 自动构建：</p>\n</div>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/jenkins-pipeline-gradle-result.png\" alt=\"jenkins-pipeline-gradle-result\" width=\"500\">\n</div>\n<div class=\"title\">Figure 7. 构建结果</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Last Successful Artifacts 包含了 zip 包</p>\n</li>\n<li>\n<p>Latest Test Result 包含了 junit 测试结果</p>\n</li>\n</ul>\n</div>\n</div>\n</div>","document":{"title":"Jenkins Pipeline: Gradle"},"pageAttributes":{"slug":"jenkins-pipeline-gradle","category":"jenkins"},"revision":{"date":"2022-07-27","number":"1.0"}}},"pageContext":{"id":"47f034eb-809f-58dc-a85b-d142c28f43a1","pageAttributes__slug":"jenkins-pipeline-gradle","__params":{"pageAttributes__slug":"jenkins-pipeline-gradle"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}