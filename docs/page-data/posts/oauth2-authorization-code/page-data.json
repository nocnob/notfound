{"componentChunkName":"component---src-pages-posts-asciidoc-page-attributes-slug-tsx","path":"/posts/oauth2-authorization-code/","result":{"data":{"asciidoc":{"id":"f98faa22-ee42-5e33-82ec-95c33fd8184b","html":"<div class=\"sect1\">\n<h2 id=\"_术语\"><a class=\"anchor\" href=\"#_术语\"></a>术语</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p>资源所有者(Resources Owner): 用户实体</p>\n</li>\n<li>\n<p>用户代理(User-Agent): 通常为浏览器</p>\n</li>\n<li>\n<p>认证服务器(Authentication Server): 可以验证资源所有者，生成访问令牌</p>\n</li>\n<li>\n<p>客户端(Client): 第三方客户端，向资源所有者的在资源服务器上的资源</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_流程\"><a class=\"anchor\" href=\"#_流程\"></a>流程</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">     +----------+\n     | Resource |\n     |   Owner  |\n     |          |\n     +----------+\n          ^\n          |\n         (B)\n     +----|-----+          Client Identifier      +---------------+\n     |         -+----(A)-- &amp; Redirection URI ----&gt;|               |\n     |  User-   |                                 | Authorization |\n     |  Agent  -+----(B)-- User authenticates ---&gt;|     Server    |\n     |          |                                 |               |\n     |         -+----(C)-- Authorization Code ---&lt;|               |\n     +-|----|---+                                 +---------------+\n       |    |                                         ^      v\n      (A)  (C)                                        |      |\n       |    |                                         |      |\n       ^    v                                         |      |\n     +---------+                                      |      |\n     |         |&gt;---(D)-- Authorization Code ---------'      |\n     |  Client |          &amp; Redirection URI                  |\n     |         |                                             |\n     |         |&lt;---(E)----- Access Token -------------------'\n     +---------+       (w/ Optional Refresh Token)\n\n   Note: The lines illustrating steps (A), (B), and (C) are broken into\n   two parts as they pass through the user-agent.\n\n                     Figure 3: Authorization Code Flow</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_三方\"><a class=\"anchor\" href=\"#_三方\"></a>三方</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">Client     &lt;--  Client ID and Client Secret --&gt; Authentication Server\n\nUser-Agent &lt;--      Username and password   --&gt; Authentication Server</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_示例\"><a class=\"anchor\" href=\"#_示例\"></a>示例</h2>\n<div class=\"sectionbody\">\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">GET http://localhost:8080/oauth2/authorization/github\n\nHTTP/1.1 302\nLocation: https://github.com/login/oauth/authorize?response_type=code&amp;client_id=532062cd2c5d82582dd5&amp;scope=read:user&amp;state=X2baH-bvudIw-ClUpxfzUf1wJr-fLAhI5FCmon79TA8%3D&amp;redirect_uri=http://localhost:8080/login/oauth2/code/github</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>第三方客户端(Client)通过浏览器(User-Agent)重定向认证服务器(Authentication Server) 传递参数:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>response_type</code> 授权类型 <code>code</code></p>\n</li>\n<li>\n<p><code>client_id</code> 客户端标识 <code>532062cd2c5d82582dd5</code></p>\n</li>\n<li>\n<p><code>scope</code> 权限范围 <code>read:user</code></p>\n</li>\n<li>\n<p><code>state</code> <code>X2baH-bvudIw-ClUpxfzUf1wJr-fLAhI5FCmon79TA8%3D</code></p>\n</li>\n<li>\n<p><code>redirect_uri</code> <a href=\"http://localhost:8080/login/oauth2/code/github\" class=\"bare\">http://localhost:8080/login/oauth2/code/github</a></p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">GET https://github.com/login/oauth/authorize?response_type=code&amp;client_id=532062cd2c5d82582dd5&amp;scope=read:user&amp;state=X2baH-bvudIw-ClUpxfzUf1wJr-fLAhI5FCmon79TA8%3D&amp;redirect_uri=http://localhost:8080/login/oauth2/code/github\n\nHTTP/1.1 302\nlocation: http://localhost:8080/login/oauth2/code/github?code=f141bfa1a77d7edbab6f&amp;state=X2baH-bvudIw-ClUpxfzUf1wJr-fLAhI5FCmon79TA8%3D</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>认证服务器(Authentication Server) 通过重定向资源服务器传递参数:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>code</code> <code>f141bfa1a77d7edbab6f</code></p>\n</li>\n<li>\n<p><code>state</code> 原封不动的传送回来 <code>X2baH-bvudIw-ClUpxfzUf1wJr-fLAhI5FCmon79TA8%3D</code></p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">GET http://localhost:8080/login/oauth2/code/github?code=f141bfa1a77d7edbab6f&amp;state=X2baH-bvudIw-ClUpxfzUf1wJr-fLAhI5FCmon79TA8%3D\n\nHTTP/1.1 302\nLocation: http://localhost:8080/</code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>用户拿到 <code>code</code> 后，向认证服务器请求访问令牌(Access Token)</p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-text\" data-lang=\"text\">GET http://localhost:8080/\nHTTP/1.1 200</code></pre>\n</div>\n</div>\n</div>\n</div>","document":{"title":"OAuth2 授权码模式"},"pageAttributes":{"slug":"oauth2-authorization-code","category":"http"},"revision":{"date":"2021-09-20","number":"1.0"}}},"pageContext":{"id":"f98faa22-ee42-5e33-82ec-95c33fd8184b","pageAttributes__slug":"oauth2-authorization-code","__params":{"pageAttributes__slug":"oauth2-authorization-code"}}},"staticQueryHashes":["3143286284"],"slicesMap":{}}